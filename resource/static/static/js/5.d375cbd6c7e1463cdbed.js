webpackJsonp([5],{SmJH:function(t,e){},eRfs:function(t,e){},"f/ib":function(t,e){},hplB:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=r("woOf"),a=r.n(o),i=r("Xxa5"),n=r.n(i),s=r("exGp"),c=r.n(s),l=r("Dd8w"),u=r.n(l),d=r("gyMJ"),p=r("NYxO"),f={name:"ProductManage",props:{createMode:Boolean,product:Object},data:function(){return{inputVisible:!1,inputValue:""}},methods:{refresh:function(){},submitProduct:function(){var t=this;return c()(n.a.mark(function e(){var r,o;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=d.a.stringUtil.pureText(t.product.description),r=d.a.stringUtil.transToHTML(r),o=t.createMode?d.a.warehouse.createProduct:d.a.warehouse.updateProduct,e.prev=3,e.next=6,o(u()({},t.product,{description:r}));case 6:t.$notify({title:"操作成功",message:t.createMode?"商品已成功创建":"商品信息已修改",type:"success"}),t.$emit("updated"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),t.$notify({title:"操作失败",message:e.t0.message,type:"error"});case 13:case"end":return e.stop()}},e,t,[[3,10]])}))()},removeSpecification:function(t){this.product.specifications.splice(this.product.specifications.indexOf(t),1)},showInput:function(){var t=this;this.inputVisible=!0,this.$nextTick(function(e){t.$refs.saveTagInput.$refs.input.focus()})},handleInputConfirm:function(){var t=this.inputValue;if(t)if((t=t.replace("：",":")).indexOf(":")>0){var e=t.split(":");this.product.specifications.push({item:e[0],value:e[1],productId:this.product.id})}else this.$alert("产品规格应该以“项目:值”的形式录入");this.inputVisible=!1,this.inputValue=""}}},m={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("el-form",{attrs:{model:t.product,"label-position":"left"}},[r("el-form-item",{attrs:{label:"商品名称","label-width":"100px"}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:t.product.title,callback:function(e){t.$set(t.product,"title",e)},expression:"product.title"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"商品售价","label-width":"100px"}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:t.product.price,callback:function(e){t.$set(t.product,"price",e)},expression:"product.price"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"商品评分","label-width":"100px"}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:t.product.rate,callback:function(e){t.$set(t.product,"rate",e)},expression:"product.rate"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"封面图片","label-width":"100px"}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:t.product.cover,callback:function(e){t.$set(t.product,"cover",e)},expression:"product.cover"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"详情图片","label-width":"100px"}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:t.product.detail,callback:function(e){t.$set(t.product,"detail",e)},expression:"product.detail"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"商品规格"}},[r("div",{staticStyle:{"padding-top":"40px"}},[t._l(t.product.specifications,function(e){return r("el-tag",{key:e.item,attrs:{closable:"",size:"medium","disable-transitions":!1},on:{close:function(r){return t.removeSpecification(e)}}},[t._v("\n        "+t._s(e.item+":"+e.value)+"\n      ")])}),t._v(" "),t.inputVisible?r("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:t.handleInputConfirm},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleInputConfirm(e)}},model:{value:t.inputValue,callback:function(e){t.inputValue=e},expression:"inputValue"}}):r("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:t.showInput}},[t._v("+ New Spec")])],2)]),t._v(" "),r("el-form-item",{attrs:{label:"商品描述"}},[r("el-input",{attrs:{type:"textarea",autosize:{minRows:7,maxRows:7}},model:{value:t.product.description,callback:function(e){t.$set(t.product,"description",e)},expression:"product.description"}})],1),t._v(" "),r("div",{staticStyle:{"text-align":"right","padding-right":"40px"}},[r("el-button",{on:{click:function(e){return t.$emit("dismiss")}}},[t._v("取 消")]),t._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:t.submitProduct}},[t._v("确 定")])],1)],1)},staticRenderFns:[]};var v=r("VU/8")(f,m,!1,function(t){r("eRfs")},"data-v-16e227fa",null).exports,b={name:"StockManage",props:{product:Object,stock:Object},data:function(){return{}},methods:{submitStock:function(){var t=this;return c()(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d.a.warehouse.updateStock(t.product.id,t.stock.amount);case 3:t.$notify({title:"操作成功",message:t.createMode?"商品已成功创建":"商品信息已修改",type:"success"}),t.$emit("dismiss"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),t.$notify({title:"操作失败",message:e.t0.message,type:"error"});case 10:case"end":return e.stop()}},e,t,[[0,7]])}))()}}},h={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("span",{staticClass:"title"},[t._v(t._s(this.product.title))]),t._v(" "),r("el-form",{attrs:{model:t.product,"label-position":"right",inline:!0}},[r("el-form-item",{attrs:{label:"可用库存","label-width":"135px"}},[r("el-input-number",{model:{value:t.stock.amount,callback:function(e){t.$set(t.stock,"amount",e)},expression:"stock.amount"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"冻结库存","label-width":"135px"}},[r("el-input-number",{attrs:{disabled:""},model:{value:t.stock.frozen,callback:function(e){t.$set(t.stock,"frozen",e)},expression:"stock.frozen"}})],1)],1),t._v(" "),r("div",{staticStyle:{"text-align":"right","padding-right":"40px"}},[r("el-button",{on:{click:function(e){return t.$emit("dismiss")}}},[t._v("取 消")]),t._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:t.submitStock}},[t._v("确 定")])],1)],1)},staticRenderFns:[]};var k={name:"WarehousePage",components:{ProductManage:v,StockManage:r("VU/8")(b,h,!1,function(t){r("SmJH")},"data-v-1730db62",null).exports},data:function(){return{products:[],product:{title:"",price:0,rate:0,cover:"",desc:"",description:"",specifications:[]},stock:{amount:0,frozen:0},createMode:!1,stockMode:!1,dialogFormVisible:!1}},created:function(){this.loadProducts()},methods:u()({},Object(p.d)("cart",["removeCartItem"]),{pureText:function(t){return d.a.stringUtil.pureText(t)},loadProducts:function(){var t=this;return c()(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.dialogFormVisible=!1,e.next=3,d.a.warehouse.getAllProducts();case 3:t.products=e.sent.data;case 4:case"end":return e.stop()}},e,t)}))()},manageProduct:function(t){this.product=a()(this.product,t),this.product.description=d.a.stringUtil.transToReturn(t.description),this.createMode=!1,this.stockMode=!1,this.dialogFormVisible=!0},manageStock:function(t){var e=this;return c()(n.a.mark(function r(){var o,a;return n.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,d.a.warehouse.queryStock(t.id);case 2:o=r.sent,a=o.data,e.stock=a,e.product=t,e.stockMode=!0,e.dialogFormVisible=!0;case 8:case"end":return r.stop()}},r,e)}))()},removeProduct:function(t){var e=this;return c()(n.a.mark(function r(){return n.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,d.a.warehouse.removeProduct(t);case 3:e.removeCartItem(t),e.loadProducts(),e.$notify({title:"操作成功",message:"商品已删除",type:"success"}),r.next=11;break;case 8:r.prev=8,r.t0=r.catch(0),e.$notify({title:"操作失败",message:r.t0.message,type:"error"});case 11:case"end":return r.stop()}},r,e,[[0,8]])}))()}})},x={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("el-card",{staticClass:"box-card"},[r("div",{staticClass:"header",attrs:{slot:"header"},slot:"header"},[r("span",[t._v("商品及库存管理")]),t._v(" "),r("span",{staticStyle:{float:"right"}},[r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){t.stockMode=!1,t.createMode=t.dialogFormVisible=!0}}},[t._v("新增商品")])],1)]),t._v(" "),r("div",{staticClass:"content"},[r("el-table",{ref:"productTable",staticStyle:{width:"100%"},attrs:{data:t.products}},[r("el-table-column",{attrs:{label:"图片",width:"150"},scopedSlots:t._u([{key:"default",fn:function(t){return[r("img",{staticStyle:{width:"120px"},attrs:{src:t.row.cover}})]}}])}),t._v(" "),r("el-table-column",{attrs:{prop:"title",label:"商品名称",sortable:"",width:"250"}}),t._v(" "),r("el-table-column",{attrs:{prop:"rate",label:"评分",width:"80",sortable:""}}),t._v(" "),r("el-table-column",{attrs:{label:"商品简介",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[r("span",{staticClass:"description"},[t._v(t._s(t.pureText(e.row.description)))])]}}])}),t._v(" "),r("el-table-column",{attrs:{prop:"price",label:"单价",width:"80",sortable:""}}),t._v(" "),r("el-table-column",{attrs:{label:"操作",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-link",{attrs:{type:"primary"},on:{click:function(r){return t.manageProduct(e.row)}}},[t._v("修改")]),t._v(" "),r("el-link",{attrs:{type:"primary"},on:{click:function(r){return t.manageStock(e.row)}}},[t._v("库存")]),t._v(" "),r("el-popconfirm",{attrs:{confirmButtonText:"确定",cancelButtonText:"我手抖了",icon:"el-icon-info",iconColor:"red",title:"确定删除这个商品吗？"},on:{onConfirm:function(r){return t.removeProduct(e.row.id)}}},[r("el-link",{attrs:{slot:"reference",type:"danger"},slot:"reference"},[t._v("删除")])],1)]}}])})],1),t._v(" "),r("el-dialog",{attrs:{title:"商品信息",visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[r("ProductManage",{directives:[{name:"show",rawName:"v-show",value:!t.stockMode,expression:"!stockMode"}],attrs:{product:t.product,"create-mode":t.createMode},on:{dismiss:function(e){t.dialogFormVisible=!1},updated:t.loadProducts}}),t._v(" "),r("StockManage",{directives:[{name:"show",rawName:"v-show",value:t.stockMode,expression:"stockMode"}],attrs:{product:t.product,stock:t.stock},on:{dismiss:function(e){t.dialogFormVisible=!1}}})],1)],1)])},staticRenderFns:[]};var g=r("VU/8")(k,x,!1,function(t){r("f/ib")},"data-v-81f8549e",null);e.default=g.exports}});